#/
 Copyright (C) 2020 Freddy Angel Cubas "Superstar64"
 Distributed under the Boost Software License, Version 1.0.
 (See accompanying file BSL.txt or copy at https://www.boost.org/LICENSE_1_0.txt)
/#

~ <a extends unrestricted> (&a[*], a[*], world &) -> world ~
copy = (from,to, os) {
	|os| = assert(from.length == to.length, os);
	if (from.length == 0) {
		os
	} else {
		(zero,|os|) = index address(to, 0, os);
		|os| = assign(zero, from[0], os);
		copy(from[1..from.length], to[1..to.length], os)
	}
};

~ world -> world ~
symbol main = os {
	base owner = [(true,true),(true,false),(false,false)];
	expected owner = [(true,true),(true,false),(false,false)];
	target owner = new array(3, ((false,false))); 
	(base, |base owner|) = base owner.borrow array;
	(expected, |expected owner|) = expected owner.borrow array;
	(target, |target owner|) = target owner.borrow array;
	|os| = copy(base,target, os);
	|os| = assert(target == expected, os);
	() = base owner.delete array;
	() = expected owner.delete array;
	() = target owner.delete array;
	|os|
};

~ (& boolean, world &) -> world ~
assert = extern "assert";
