#/Copyright (C) 2018  Freddy Angel Cubas "Superstar64"
 Boost License
/#

void = tuple();

increment = >(x) = {
	x <- *x + 1;
};

heap pointer = >() = {
	let pointer : integer 32(*) = new 5;
	assert(*pointer == 5);
	increment(pointer);
	assert(*pointer == 6);
	
	assert(pointer == pointer);
};

array pointer = >() =  {
	let array : integer 32[*] = [0,10,20];
	let index = array&[1];
	assert(array[1] == 10);
	increment(index);
	assert(array[1] == 11);
	assert(array&[1] == array&[1]);
	assert(array&[1] != array&[2]);
};


record pointer = >() =  {
	let pair = new (4 : integer 32,10 : integer 32);
	assert((*pair)_0 == 4);
	increment(pair&_0);
	assert((*pair)_0 == 5);
	
	assert((*pair)_1 == 10);
	increment(pair&_1);
	assert((*pair)_1 == 11);
	
	
	assert(pair&_0 == pair&_0);
	assert(pair&_0 != pair&_1);
	assert(pair == pair);
};


main : void -> void = >() = {
	heap pointer();
	array pointer();
	record pointer();
};

assert : boolean -> void = extern "assert";
